package dev.aikido.agent_api.vulnerabilities;

import dev.aikido.agent_api.context.ContextObject;
import dev.aikido.agent_api.thread_cache.ThreadCache;
import dev.aikido.agent_api.thread_cache.ThreadCacheObject;

public class SkipVulnerabilityScanDecider {
    public static boolean shouldSkipVulnerabilityScan(ContextObject context) {
        if (context == null) {
            return true;
        }
        ThreadCacheObject threadCache = ThreadCache.get();
        if (threadCache != null) {
            if (threadCache.isBypassedIP(context.getRemoteAddress())) {
                return true; // Bypassed IP Addresses are not subject to vulnerability scans
            }
        }
        return false;
    }
}
